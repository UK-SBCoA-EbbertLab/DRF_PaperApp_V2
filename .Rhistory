sum(hg38_v_chm13_strand$Type == "SyntenicAndNonSyntenicDuplications")
sum(hg38_v_chm13_strand[which(hg38_v_chm13_strand$Type == "SyntenicAndNonSyntenicDuplications"), "CHM13_NumCopies"])
sum(hg38_v_chm13_strand[which(hg38_v_chm13_strand$Type == "NonSyntenicMultipleCopies"), "CHM13_NumCopies"])
sum(hg38_v_chm13_strand[which(hg38_v_chm13_strand$Type == "SyntenicDuplications"), "CHM13_NumCopies"])
q
Illumina250.CHM13.darkMerged = read.table("data/Illumina250_CHM13/Updated_Output_01_18_2024/Illumina250.Illumina250.T2T_CHM13_v2.0.dark-merged.bed", sep="\t", stringsAsFactors = F, header=F)
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp/DarkRegionApp.R", echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(reshape2)
library(ggplot2)
library(gridExtra)
library(RIdeogram)
## Illumina100RL
### CHM13
Illumina100.CHM13.darkMerged = read.table("data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.dark-merged.bed", sep="\t", stringsAsFactors = F, header=F)
## Illumina100RL
### CHM13
Illumina100.CHM13.darkMerged = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.dark-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.CHM13.darkMerged$size = Illumina100.CHM13.darkMerged$V3 - Illumina100.CHM13.darkMerged$V2
Illumina100.CHM13.depthMerged = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.low_depth-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.CHM13.depthMerged$size = Illumina100.CHM13.depthMerged$V3 - Illumina100.CHM13.depthMerged$V2
Illumina100.CHM13.mapqMerged = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.low_mapq-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.CHM13.mapqMerged$size = Illumina100.CHM13.mapqMerged$V3 - Illumina100.CHM13.mapqMerged$V2
dark.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_dark_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
depth.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_depth_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
mapq.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_mapq_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
camo.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_camo_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
### HG38_noAlt
Illumina100.HG38_noAlt.darkMerged = read.table("../data/Illumina100_HG38_noAlt/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.HG38_noAlt.dark-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.HG38_noAlt.darkMerged$size = Illumina100.HG38_noAlt.darkMerged$V3 - Illumina100.HG38_noAlt.darkMerged$V2
Illumina100.HG38_noAlt.depthMerged = read.table("../data/Illumina100_HG38_noAlt/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.HG38_noAlt.low_depth-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.HG38_noAlt.depthMerged$size = Illumina100.HG38_noAlt.depthMerged$V3 - Illumina100.HG38_noAlt.depthMerged$V2
Illumina100.HG38_noAlt.mapqMerged = read.table("../data/Illumina100_HG38_noAlt/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.HG38_noAlt.low_mapq-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.HG38_noAlt.mapqMerged$size = Illumina100.HG38_noAlt.mapqMerged$V3 - Illumina100.HG38_noAlt.mapqMerged$V2
dark.Illumina100.HG38_noAlt.biotype = read.table("../data/Illumina100_HG38_noAlt/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.HG38_noAlt.percent_dark_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
depth.Illumina100.HG38_noAlt.biotype = read.table("../data/Illumina100_HG38_noAlt/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.HG38_noAlt.percent_depth_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
mapq.Illumina100.HG38_noAlt.biotype = read.table("../data/Illumina100_HG38_noAlt/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.HG38_noAlt.percent_mapq_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
camo.Illumina100.HG38_noAlt.biotype = read.table("../data/Illumina100_HG38_noAlt/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.HG38_noAlt.percent_camo_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
Illumina100.CHM13.darkMerged
nucsAndRegions = data.frame(
"Region_type"=c(rep(c("All_Dark","Low_Depth", "Low_Mapq"), 16)),
"Platform"=c(rep("Illumina100", 3),  rep("Illumina100", 3)),
"Reference"=c(rep("CHM13", 3), rep("HG38_noAlt", 3)),
"Nucleotide_count"=c(sum(Illumina100.CHM13.darkMerged$size), sum(Illumina100.CHM13.depthMerged$size), sum(Illumina100.CHM13.mapqMerged$size),
sum(Illumina100.HG38_noAlt.darkMerged$size), sum(Illumina100.HG38_noAlt.depthMerged$size), sum(Illumina100.HG38_noAlt.mapqMerged$size)),
"Region_count"=c(length(Illumina100.CHM13.darkMerged$size), length(Illumina100.CHM13.depthMerged$size), length(Illumina100.CHM13.mapqMerged$size),
length(Illumina100.HG38_noAlt.darkMerged$size), length(Illumina100.HG38_noAlt.depthMerged$size), length(Illumina100.HG38_noAlt.mapqMerged$size)),
"Mean_Nucleotide_per_Region"=c(mean(Illumina100.CHM13.darkMerged$size), mean(Illumina100.CHM13.depthMerged$size), mean(Illumina100.CHM13.mapqMerged$size),
mean(Illumina100.HG38_noAlt.darkMerged$size), mean(Illumina100.HG38_noAlt.depthMerged$size), mean(Illumina100.HG38_noAlt.mapqMerged$size)),
"Median_Nucleotide_per_Region"=c(median(Illumina100.CHM13.darkMerged$size), median(Illumina100.CHM13.depthMerged$size), median(Illumina100.CHM13.mapqMerged$size),
median(Illumina100.HG38_noAlt.darkMerged$size), median(Illumina100.HG38_noAlt.depthMerged$size), median(Illumina100.HG38_noAlt.mapqMerged$size)),
)
nucsAndRegions = data.frame(
"Region_type"=c(rep(c("All_Dark","Low_Depth", "Low_Mapq"), 16)),
"Platform"=c(rep("Illumina100", 3),  rep("Illumina100", 3)),
"Reference"=c(rep("CHM13", 3), rep("HG38_noAlt", 3)),
"Nucleotide_count"=c(sum(Illumina100.CHM13.darkMerged$size), sum(Illumina100.CHM13.depthMerged$size), sum(Illumina100.CHM13.mapqMerged$size),
sum(Illumina100.HG38_noAlt.darkMerged$size), sum(Illumina100.HG38_noAlt.depthMerged$size), sum(Illumina100.HG38_noAlt.mapqMerged$size)),
"Region_count"=c(length(Illumina100.CHM13.darkMerged$size), length(Illumina100.CHM13.depthMerged$size), length(Illumina100.CHM13.mapqMerged$size),
length(Illumina100.HG38_noAlt.darkMerged$size), length(Illumina100.HG38_noAlt.depthMerged$size), length(Illumina100.HG38_noAlt.mapqMerged$size)),
"Mean_Nucleotide_per_Region"=c(mean(Illumina100.CHM13.darkMerged$size), mean(Illumina100.CHM13.depthMerged$size), mean(Illumina100.CHM13.mapqMerged$size),
mean(Illumina100.HG38_noAlt.darkMerged$size), mean(Illumina100.HG38_noAlt.depthMerged$size), mean(Illumina100.HG38_noAlt.mapqMerged$size)),
"Median_Nucleotide_per_Region"=c(median(Illumina100.CHM13.darkMerged$size), median(Illumina100.CHM13.depthMerged$size), median(Illumina100.CHM13.mapqMerged$size),
median(Illumina100.HG38_noAlt.darkMerged$size), median(Illumina100.HG38_noAlt.depthMerged$size), median(Illumina100.HG38_noAlt.mapqMerged$size)),
)
nucsAndRegions = data.frame(
"Region_type"=c(rep(c("All_Dark","Low_Depth", "Low_Mapq"), 2)),
"Platform"=c(rep("Illumina100", 3),  rep("Illumina100", 3)),
"Reference"=c(rep("CHM13", 3), rep("HG38_noAlt", 3)),
"Nucleotide_count"=c(sum(Illumina100.CHM13.darkMerged$size), sum(Illumina100.CHM13.depthMerged$size), sum(Illumina100.CHM13.mapqMerged$size),
sum(Illumina100.HG38_noAlt.darkMerged$size), sum(Illumina100.HG38_noAlt.depthMerged$size), sum(Illumina100.HG38_noAlt.mapqMerged$size)),
"Region_count"=c(length(Illumina100.CHM13.darkMerged$size), length(Illumina100.CHM13.depthMerged$size), length(Illumina100.CHM13.mapqMerged$size),
length(Illumina100.HG38_noAlt.darkMerged$size), length(Illumina100.HG38_noAlt.depthMerged$size), length(Illumina100.HG38_noAlt.mapqMerged$size)),
"Mean_Nucleotide_per_Region"=c(mean(Illumina100.CHM13.darkMerged$size), mean(Illumina100.CHM13.depthMerged$size), mean(Illumina100.CHM13.mapqMerged$size),
mean(Illumina100.HG38_noAlt.darkMerged$size), mean(Illumina100.HG38_noAlt.depthMerged$size), mean(Illumina100.HG38_noAlt.mapqMerged$size)),
"Median_Nucleotide_per_Region"=c(median(Illumina100.CHM13.darkMerged$size), median(Illumina100.CHM13.depthMerged$size), median(Illumina100.CHM13.mapqMerged$size),
median(Illumina100.HG38_noAlt.darkMerged$size), median(Illumina100.HG38_noAlt.depthMerged$size), median(Illumina100.HG38_noAlt.mapqMerged$size)),
)
nucsAndRegions = data.frame(
"Region_type"=c(rep(c("All_Dark","Low_Depth", "Low_Mapq"), 2)),
"Platform"=c(rep("Illumina100", 3),  rep("Illumina100", 3)),
"Reference"=c(rep("CHM13", 3), rep("HG38_noAlt", 3)),
"Nucleotide_count"=c(sum(Illumina100.CHM13.darkMerged$size), sum(Illumina100.CHM13.depthMerged$size), sum(Illumina100.CHM13.mapqMerged$size),
sum(Illumina100.HG38_noAlt.darkMerged$size), sum(Illumina100.HG38_noAlt.depthMerged$size), sum(Illumina100.HG38_noAlt.mapqMerged$size)),
"Region_count"=c(length(Illumina100.CHM13.darkMerged$size), length(Illumina100.CHM13.depthMerged$size), length(Illumina100.CHM13.mapqMerged$size),
length(Illumina100.HG38_noAlt.darkMerged$size), length(Illumina100.HG38_noAlt.depthMerged$size), length(Illumina100.HG38_noAlt.mapqMerged$size)),
"Mean_Nucleotide_per_Region"=c(mean(Illumina100.CHM13.darkMerged$size), mean(Illumina100.CHM13.depthMerged$size), mean(Illumina100.CHM13.mapqMerged$size),
mean(Illumina100.HG38_noAlt.darkMerged$size), mean(Illumina100.HG38_noAlt.depthMerged$size), mean(Illumina100.HG38_noAlt.mapqMerged$size)),
"Median_Nucleotide_per_Region"=c(median(Illumina100.CHM13.darkMerged$size), median(Illumina100.CHM13.depthMerged$size), median(Illumina100.CHM13.mapqMerged$size),
median(Illumina100.HG38_noAlt.darkMerged$size), median(Illumina100.HG38_noAlt.depthMerged$size), median(Illumina100.HG38_noAlt.mapqMerged$size))
)
biotype=rbind(data.frame("biotype"=dark.Illumina100.CHM13.biotype[,1, drop=T], "AllDark"=dark.Illumina100.CHM13.biotype[,2, drop=T], "Dark_by_Depth"=depth.Illumina100.CHM13.biotype[,2, drop=T],"Dark_by_MapQ"= mapq.Illumina100.CHM13.biotype[,2, drop=T], "Camo"= camo.Illumina100.CHM13.biotype[,2, drop=T], "Platform"=rep("Illumina100RL", 8), "Reference"= rep("CHM13", 8)),
data.frame("biotype"=dark.Illumina100.HG38_noAlt.biotype[,1, drop=T], "AllDark"=dark.Illumina100.HG38_noAlt.biotype[,2, drop=T], "Dark_by_Depth"=depth.Illumina100.HG38_noAlt.biotype[,2, drop=T],"Dark_by_MapQ"= mapq.Illumina100.HG38_noAlt.biotype[,2, drop=T], "Camo"= camo.Illumina100.HG38_noAlt.biotype[,2, drop=T], "Platform"=rep("Illumina100RL", 8), "Reference"= rep("HG38_noAlt", 8))
)
nucsAndRegions
ggplot(nucsAndRegions, aes(x=RegionType, y=Nucleotide_count, fill=Reference)) + geom_bar(stat="identity")
ggplot(nucsAndRegions, aes(x=Region_type, y=Nucleotide_count, fill=Reference)) + geom_bar(stat="identity")
ggplot(nucsAndRegions, aes(x=Region_type, y=Nucleotide_count, fill=Reference)) + geom_bar(stat="identity", position="doddge")
ggplot(nucsAndRegions, aes(x=Region_type, y=Nucleotide_count, fill=Reference)) + geom_bar(stat="identity", position="dodge")
ggplot(nucsAndRegions[which(nucsAndRegions$Region_type == "AllDark"),], aes(x=Region_type, y=Nucleotide_count, fill=Reference)) + geom_bar(stat="identity", position="dodge")
ggplot(nucsAndRegions[which(nucsAndRegions$Region_type == "All_Dark"),], aes(x=Region_type, y=Nucleotide_count, fill=Reference)) + geom_bar(stat="identity", position="dodge")
ggplot(nucsAndRegions[which(nucsAndRegions$Region_type == "All_Dark"),], aes(x=Region_type, y=Nucleotide_count/1000000, fill=Reference)) + geom_bar(stat="identity", position="dodge")
ggplot(nucsAndRegions[which(nucsAndRegions$Region_type == "All_Dark"),], aes(x=Reference, y=Nucleotide_count/1000000, fill=Reference)) + geom_bar(stat="identity", position="dodge") + xlab("") + ylab("Number of Dark Bases (Mb)")
ggplot(nucsAndRegions[which(nucsAndRegions$Region_type == "All_Dark"),], aes(x=Reference, y=Nucleotide_count/1000000, fill=Reference)) + geom_bar(stat="identity", position="dodge") + xlab("") + ylab("Number of Dark Bases (Mb)") + theme_bw()
p=ggplot(nucsAndRegions[which(nucsAndRegions$Region_type == "All_Dark"),], aes(x=Reference, y=Nucleotide_count/1000000, fill=Reference)) + geom_bar(stat="identity", position="dodge") + xlab("") + ylab("Number of Dark Bases (Mb)") + theme_bw()
p
pdf("DarkBases_Reference.pdf", width=3, height=4)
p
dev.off()
pdf("DarkBases_Reference.pdf", width=4, height=3)
p
dev.off()
p=ggplot(nucsAndRegions[which(nucsAndRegions$Region_type == "All_Dark"),], aes(x=Reference, y=Nucleotide_count/1000000, fill=Reference)) + geom_bar(stat="identity", position="dodge") + xlab("") + ylab("Number of Dark Bases (Mb)") + theme_bw()
p
pdf("DarkBases_Reference.pdf", width=4, height=3)
p
dev.off()
nucsAndRegions
nucsAndRegions = data.frame(
"Region_type"=c(rep(c("All_Dark","Low_Depth", "Low_Mapq"), 2)),
"Platform"=c(rep("Illumina100", 3),  rep("Illumina100", 3)),
"Reference"=c(rep("CHM13", 3), rep("HG38_noAlt", 3)),
"Nucleotide_count"=c(sum(Illumina100.CHM13.darkMerged$size), sum(Illumina100.CHM13.depthMerged$size), sum(Illumina100.CHM13.mapqMerged$size),
sum(Illumina100.HG38_Alt.darkMerged$size), sum(Illumina100.HG38_Alt.depthMerged$size), sum(Illumina100.HG38_Alt.mapqMerged$size)),
"Region_count"=c(length(Illumina100.CHM13.darkMerged$size), length(Illumina100.CHM13.depthMerged$size), length(Illumina100.CHM13.mapqMerged$size),
length(Illumina100.HG38_Alt.darkMerged$size), length(Illumina100.HG38_Alt.depthMerged$size), length(Illumina100.HG38_Alt.mapqMerged$size)),
"Mean_Nucleotide_per_Region"=c(mean(Illumina100.CHM13.darkMerged$size), mean(Illumina100.CHM13.depthMerged$size), mean(Illumina100.CHM13.mapqMerged$size),
mean(Illumina100.HG38_Alt.darkMerged$size), mean(Illumina100.HG38_Alt.depthMerged$size), mean(Illumina100.HG38_Alt.mapqMerged$size)),
"Median_Nucleotide_per_Region"=c(median(Illumina100.CHM13.darkMerged$size), median(Illumina100.CHM13.depthMerged$size), median(Illumina100.CHM13.mapqMerged$size),
median(Illumina100.HG38_Alt.darkMerged$size), median(Illumina100.HG38_Alt.depthMerged$size), median(Illumina100.HG38_Alt.mapqMerged$size))
)
nucsAndRegions = data.frame(
"Region_type"=c(rep(c("All_Dark","Low_Depth", "Low_Mapq"), 2)),
"Platform"=c(rep("Illumina100", 3),  rep("Illumina100", 3)),
"Reference"=c(rep("CHM13", 3), rep("HG38_noAlt", 3)),
"Nucleotide_count"=c(sum(Illumina100.CHM13.darkMerged$size), sum(Illumina100.CHM13.depthMerged$size), sum(Illumina100.CHM13.mapqMerged$size),
sum(Illumina100.HG38_alt.darkMerged$size), sum(Illumina100.HG38_alt.depthMerged$size), sum(Illumina100.HG38_alt.mapqMerged$size)),
"Region_count"=c(length(Illumina100.CHM13.darkMerged$size), length(Illumina100.CHM13.depthMerged$size), length(Illumina100.CHM13.mapqMerged$size),
length(Illumina100.HG38_alt.darkMerged$size), length(Illumina100.HG38_alt.depthMerged$size), length(Illumina100.HG38_alt.mapqMerged$size)),
"Mean_Nucleotide_per_Region"=c(mean(Illumina100.CHM13.darkMerged$size), mean(Illumina100.CHM13.depthMerged$size), mean(Illumina100.CHM13.mapqMerged$size),
mean(Illumina100.HG38_alt.darkMerged$size), mean(Illumina100.HG38_alt.depthMerged$size), mean(Illumina100.HG38_alt.mapqMerged$size)),
"Median_Nucleotide_per_Region"=c(median(Illumina100.CHM13.darkMerged$size), median(Illumina100.CHM13.depthMerged$size), median(Illumina100.CHM13.mapqMerged$size),
median(Illumina100.HG38_alt.darkMerged$size), median(Illumina100.HG38_alt.depthMerged$size), median(Illumina100.HG38_alt.mapqMerged$size))
)
## Illumina100RL
### CHM13
Illumina100.CHM13.darkMerged = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.dark-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.CHM13.darkMerged$size = Illumina100.CHM13.darkMerged$V3 - Illumina100.CHM13.darkMerged$V2
Illumina100.CHM13.depthMerged = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.low_depth-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.CHM13.depthMerged$size = Illumina100.CHM13.depthMerged$V3 - Illumina100.CHM13.depthMerged$V2
Illumina100.CHM13.mapqMerged = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.low_mapq-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.CHM13.mapqMerged$size = Illumina100.CHM13.mapqMerged$V3 - Illumina100.CHM13.mapqMerged$V2
dark.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_dark_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
depth.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_depth_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
mapq.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_mapq_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
camo.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_camo_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
### HG38_Alt
Illumina100.HG38_Alt.darkMerged = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.dark-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.HG38_Alt.darkMerged$size = Illumina100.HG38_Alt.darkMerged$V3 - Illumina100.HG38_Alt.darkMerged$V2
Illumina100.HG38_Alt.depthMerged = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.low_depth-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.HG38_Alt.depthMerged$size = Illumina100.HG38_Alt.depthMerged$V3 - Illumina100.HG38_Alt.depthMerged$V2
Illumina100.HG38_Alt.mapqMerged = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.low_mapq-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.HG38_Alt.mapqMerged$size = Illumina100.HG38_Alt.mapqMerged$V3 - Illumina100.HG38_Alt.mapqMerged$V2
dark.Illumina100.HG38_Alt.biotype = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.percent_dark_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
depth.Illumina100.HG38_Alt.biotype = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.HG38_Alt.percent_depth_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
nucsAndRegions = data.frame(
"Region_type"=c(rep(c("All_Dark","Low_Depth", "Low_Mapq"), 2)),
"Platform"=c(rep("Illumina100", 3),  rep("Illumina100", 3)),
"Reference"=c(rep("CHM13", 3), rep("HG38_Alt", 3)),
"Nucleotide_count"=c(sum(Illumina100.CHM13.darkMerged$size), sum(Illumina100.CHM13.depthMerged$size), sum(Illumina100.CHM13.mapqMerged$size),
sum(Illumina100.HG38.darkMerged$size), sum(Illumina100.HG38_Alt.depthMerged$size), sum(Illumina100.HG38_Alt.mapqMerged$size)),
"Region_count"=c(length(Illumina100.CHM13.darkMerged$size), length(Illumina100.CHM13.depthMerged$size), length(Illumina100.CHM13.mapqMerged$size),
length(Illumina100.HG38_Alt.darkMerged$size), length(Illumina100.HG38_Alt.depthMerged$size), length(Illumina100.HG38_Alt.mapqMerged$size)),
"Mean_Nucleotide_per_Region"=c(mean(Illumina100.CHM13.darkMerged$size), mean(Illumina100.CHM13.depthMerged$size), mean(Illumina100.CHM13.mapqMerged$size),
mean(Illumina100.HG38_Alt.darkMerged$size), mean(Illumina100.HG38_Alt.depthMerged$size), mean(Illumina100.HG38_Alt.mapqMerged$size)),
"Median_Nucleotide_per_Region"=c(median(Illumina100.CHM13.darkMerged$size), median(Illumina100.CHM13.depthMerged$size), median(Illumina100.CHM13.mapqMerged$size),
median(Illumina100.HG38_Alt.darkMerged$size), median(Illumina100.HG38_Alt.depthMerged$size), median(Illumina100.HG38_Alt.mapqMerged$size))
)
nucsAndRegions = data.frame(
"Region_type"=c(rep(c("All_Dark","Low_Depth", "Low_Mapq"), 2)),
"Platform"=c(rep("Illumina100", 3),  rep("Illumina100", 3)),
"Reference"=c(rep("CHM13", 3), rep("HG38_Alt", 3)),
"Nucleotide_count"=c(sum(Illumina100.CHM13.darkMerged$size), sum(Illumina100.CHM13.depthMerged$size), sum(Illumina100.CHM13.mapqMerged$size),
sum(Illumina100.HG38_Alt.darkMerged$size), sum(Illumina100.HG38_Alt.depthMerged$size), sum(Illumina100.HG38_Alt.mapqMerged$size)),
"Region_count"=c(length(Illumina100.CHM13.darkMerged$size), length(Illumina100.CHM13.depthMerged$size), length(Illumina100.CHM13.mapqMerged$size),
length(Illumina100.HG38_Alt.darkMerged$size), length(Illumina100.HG38_Alt.depthMerged$size), length(Illumina100.HG38_Alt.mapqMerged$size)),
"Mean_Nucleotide_per_Region"=c(mean(Illumina100.CHM13.darkMerged$size), mean(Illumina100.CHM13.depthMerged$size), mean(Illumina100.CHM13.mapqMerged$size),
mean(Illumina100.HG38_Alt.darkMerged$size), mean(Illumina100.HG38_Alt.depthMerged$size), mean(Illumina100.HG38_Alt.mapqMerged$size)),
"Median_Nucleotide_per_Region"=c(median(Illumina100.CHM13.darkMerged$size), median(Illumina100.CHM13.depthMerged$size), median(Illumina100.CHM13.mapqMerged$size),
median(Illumina100.HG38_Alt.darkMerged$size), median(Illumina100.HG38_Alt.depthMerged$size), median(Illumina100.HG38_Alt.mapqMerged$size))
)
biotype=rbind(data.frame("biotype"=dark.Illumina100.CHM13.biotype[,1, drop=T], "AllDark"=dark.Illumina100.CHM13.biotype[,2, drop=T], "Dark_by_Depth"=depth.Illumina100.CHM13.biotype[,2, drop=T],"Dark_by_MapQ"= mapq.Illumina100.CHM13.biotype[,2, drop=T], "Camo"= camo.Illumina100.CHM13.biotype[,2, drop=T], "Platform"=rep("Illumina100RL", 8), "Reference"= rep("CHM13", 8)),
data.frame("biotype"=dark.Illumina100.HG38_Alt.biotype[,1, drop=T], "AllDark"=dark.Illumina100.HG38_Alt.biotype[,2, drop=T], "Dark_by_Depth"=depth.Illumina100.HG38_Alt.biotype[,2, drop=T],"Dark_by_MapQ"= mapq.Illumina100.HG38_Alt.biotype[,2, drop=T], "Camo"= camo.Illumina100.HG38_Alt.biotype[,2, drop=T], "Platform"=rep("Illumina100RL", 8), "Reference"= rep("HG38_Alt", 8))
)
## Illumina100RL
### CHM13
Illumina100.CHM13.darkMerged = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.dark-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.CHM13.darkMerged$size = Illumina100.CHM13.darkMerged$V3 - Illumina100.CHM13.darkMerged$V2
Illumina100.CHM13.depthMerged = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.low_depth-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.CHM13.depthMerged$size = Illumina100.CHM13.depthMerged$V3 - Illumina100.CHM13.depthMerged$V2
Illumina100.CHM13.mapqMerged = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.low_mapq-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.CHM13.mapqMerged$size = Illumina100.CHM13.mapqMerged$V3 - Illumina100.CHM13.mapqMerged$V2
dark.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_dark_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
depth.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_depth_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
mapq.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_mapq_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
camo.Illumina100.CHM13.biotype = read.table("../data/Illumina100_CHM13/Updated_output_07_17_2023/originalADSP.Illumina_OriginalADSP.T2T_CHM13_v2.0.percent_camo_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
### HG38_Alt
Illumina100.HG38_Alt.darkMerged = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.dark-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.HG38_Alt.darkMerged$size = Illumina100.HG38_Alt.darkMerged$V3 - Illumina100.HG38_Alt.darkMerged$V2
Illumina100.HG38_Alt.depthMerged = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.low_depth-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.HG38_Alt.depthMerged$size = Illumina100.HG38_Alt.depthMerged$V3 - Illumina100.HG38_Alt.depthMerged$V2
Illumina100.HG38_Alt.mapqMerged = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.low_mapq-merged.bed", sep="\t", stringsAsFactors = F, header=F)
Illumina100.HG38_Alt.mapqMerged$size = Illumina100.HG38_Alt.mapqMerged$V3 - Illumina100.HG38_Alt.mapqMerged$V2
dark.Illumina100.HG38_Alt.biotype = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.percent_dark_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
depth.Illumina100.HG38_Alt.biotype = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.percent_depth_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
mapq.Illumina100.HG38_Alt.biotype = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.percent_mapq_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
camo.Illumina100.HG38_Alt.biotype = read.table("../data/Illumina100_HG38_Alt/Updated_output_07_17_2023/illuminaRL100.1KGenomes_hg38_plus_decoy.percent_camo_biotypes.txt", sep="\t", stringsAsFactors = F, header=T)
nucsAndRegions = data.frame(
"Region_type"=c(rep(c("All_Dark","Low_Depth", "Low_Mapq"), 2)),
"Platform"=c(rep("Illumina100", 3),  rep("Illumina100", 3)),
"Reference"=c(rep("CHM13", 3), rep("HG38_Alt", 3)),
"Nucleotide_count"=c(sum(Illumina100.CHM13.darkMerged$size), sum(Illumina100.CHM13.depthMerged$size), sum(Illumina100.CHM13.mapqMerged$size),
sum(Illumina100.HG38_Alt.darkMerged$size), sum(Illumina100.HG38_Alt.depthMerged$size), sum(Illumina100.HG38_Alt.mapqMerged$size)),
"Region_count"=c(length(Illumina100.CHM13.darkMerged$size), length(Illumina100.CHM13.depthMerged$size), length(Illumina100.CHM13.mapqMerged$size),
length(Illumina100.HG38_Alt.darkMerged$size), length(Illumina100.HG38_Alt.depthMerged$size), length(Illumina100.HG38_Alt.mapqMerged$size)),
"Mean_Nucleotide_per_Region"=c(mean(Illumina100.CHM13.darkMerged$size), mean(Illumina100.CHM13.depthMerged$size), mean(Illumina100.CHM13.mapqMerged$size),
mean(Illumina100.HG38_Alt.darkMerged$size), mean(Illumina100.HG38_Alt.depthMerged$size), mean(Illumina100.HG38_Alt.mapqMerged$size)),
"Median_Nucleotide_per_Region"=c(median(Illumina100.CHM13.darkMerged$size), median(Illumina100.CHM13.depthMerged$size), median(Illumina100.CHM13.mapqMerged$size),
median(Illumina100.HG38_Alt.darkMerged$size), median(Illumina100.HG38_Alt.depthMerged$size), median(Illumina100.HG38_Alt.mapqMerged$size))
)
biotype=rbind(data.frame("biotype"=dark.Illumina100.CHM13.biotype[,1, drop=T], "AllDark"=dark.Illumina100.CHM13.biotype[,2, drop=T], "Dark_by_Depth"=depth.Illumina100.CHM13.biotype[,2, drop=T],"Dark_by_MapQ"= mapq.Illumina100.CHM13.biotype[,2, drop=T], "Camo"= camo.Illumina100.CHM13.biotype[,2, drop=T], "Platform"=rep("Illumina100RL", 8), "Reference"= rep("CHM13", 8)),
data.frame("biotype"=dark.Illumina100.HG38_Alt.biotype[,1, drop=T], "AllDark"=dark.Illumina100.HG38_Alt.biotype[,2, drop=T], "Dark_by_Depth"=depth.Illumina100.HG38_Alt.biotype[,2, drop=T],"Dark_by_MapQ"= mapq.Illumina100.HG38_Alt.biotype[,2, drop=T], "Camo"= camo.Illumina100.HG38_Alt.biotype[,2, drop=T], "Platform"=rep("Illumina100RL", 8), "Reference"= rep("HG38_Alt", 8))
)
p=ggplot(nucsAndRegions[which(nucsAndRegions$Region_type == "All_Dark"),], aes(x=Reference, y=Nucleotide_count/1000000, fill=Reference)) + geom_bar(stat="identity", position="dodge") + xlab("") + ylab("Number of Dark Bases (Mb)") + theme_bw()
p
pdf("DarkBases_Reference.pdf", width=4, height=3)
p
dev.off()
nucsAndRegions
p=ggplot(nucsAndRegions[which(nucsAndRegions$Region_type == "Low_Mapq"),], aes(x=Reference, y=Nucleotide_count/1000000, fill=Reference)) + geom_bar(stat="identity", position="dodge") + xlab("") + ylab("Number of Dark Bases (Mb)") + theme_bw()
p
pdf("DarkMAPQ_Reference.pdf", width=4, height=3)
p
dev.off()
26842346/206689498
knitr::opts_chunk$set(echo = TRUE)
library(reshape2)
library(ggplot2)
library(ComplexHeatmap)
library(RIdeogram)
library(wordcloud2)
chm13RefSize = read.table("../../../CHM13PaperFigures/referenceSizes/CHM13.chromSizes.txt", header=F,sep="\t")
chm13RefSize[which(chm13RefSize$V1 == "chrM"), "V1"] = "chrMT"
hg38RefSize = read.table("../../../CHM13PaperFigures/referenceSizes/hg38.assembledOnly.chrom.sizes", header=F,sep="\t")
hg38RefSize[which(hg38RefSize$V1 == "chrM"), "V1"] = "chrMT"
hg19RefSize = read.table("../../../CHM13PaperFigures/referenceSizes/hg19.assembledOnly.chrom.sizes", header=F,sep="\t")
chm13Ref = data.frame("Chr"=chm13RefSize$V1, "Start"=rep(1, nrow(chm13RefSize)), "End"=chm13RefSize$V2, "fill"=rep("fcb06b", nrow(chm13RefSize)), "species"=rep("CHM13", nrow(chm13RefSize)), "size"=rep(12, nrow(chm13RefSize)), "color"=rep("fcb06b", nrow(chm13RefSize)))
hg38Ref = data.frame("Chr"=hg38RefSize$V1, "Start"=rep(1, nrow(hg38RefSize)), "End"=hg38RefSize$V2, "fill"=rep("078dd8", nrow(hg38RefSize)), "species"=rep("HG38", nrow(hg38RefSize)), "size"=rep(12, nrow(hg38RefSize)), "color"=rep("078dd8", nrow(hg38RefSize)))
hg19Ref = data.frame("Chr"=hg19RefSize$V1, "Start"=rep(1, nrow(hg19RefSize)), "End"=hg19RefSize$V2, "fill"=rep("139b08", nrow(hg19RefSize)), "species"=rep("HG19", nrow(hg19RefSize)), "size"=rep(12, nrow(hg19RefSize)), "color"=rep("139b08", nrow(hg19RefSize)))
hg38.chm13.ref = rbind(hg38Ref, chm13Ref)
hg19.chm13.ref = rbind(hg19Ref, chm13Ref)
hg19.hg38.chm13.ref = rbind(chm13Ref, hg19Ref, hg38Ref)
chm13_genes = read.table("chm13.v2.0.geneTable.txt", sep="\t", header=T, stringsAsFactors = F)
chm13_genes[which(chm13_genes$chr == "chrM"),"chr"] = "chrMT"
chm13_genes$ensembl = unlist(lapply(strsplit(chm13_genes$source_gene, "\\."), `[`, 1))
hg38_genes = read.table("hg38.v101.geneTable.txt", sep="\t", header=T, stringsAsFactors = F)
rownames(hg38_genes) = hg38_genes$gene_id
hg19_genes = read.table("hg19.v87.geneTable.txt", sep="\t", header=T, stringsAsFactors = F)
rownames(hg19_genes) = hg19_genes$gene_id
hg19_genes$chrAdded = paste0("chr", hg19_genes$chr)
hg38_genes$chrAdded = paste0("chr", hg38_genes$chr)
length(unique(chm13_genes$ensembl))
length(rownames(hg38_genes))
length(intersect(unique(chm13_genes$ensembl), rownames(hg38_genes)))
length(setdiff(unique(chm13_genes$ensembl), rownames(hg38_genes)))
length(setdiff(rownames(hg38_genes), unique(chm13_genes$ensembl)))
table(chm13_genes$chr)
hg38_v_chm13_chr = data.frame(ensembl=intersect(unique(chm13_genes$ensembl), rownames(hg38_genes)), HG38_chr=rep(NA,length(intersect(unique(chm13_genes$ensembl), rownames(hg38_genes)))), CHM13_chr=rep(NA, length(intersect(unique(chm13_genes$ensembl), rownames(hg38_genes)))))
hg38_v_chm13_chr$HG38_chr=paste0("chr",hg38_genes[hg38_v_chm13_chr$ensembl, "chr"])
hg38_v_chm13_chr$CHM13_chr=sapply(1:nrow(hg38_v_chm13_chr), function(i) paste(chm13_genes[which(chm13_genes$ensembl == hg38_v_chm13_chr[i, "ensembl"]),"chr"], collapse = ","))
nrow(hg38_v_chm13_chr[which(hg38_v_chm13_chr$HG38_chr == hg38_v_chm13_chr$CHM13_chr),])
nrow(hg38_v_chm13_chr[which(hg38_v_chm13_chr$HG38_chr != hg38_v_chm13_chr$CHM13_chr),])
hg38_genes$chrAdded = paste0("chr", hg38_genes$chr)
hg38_v_chm13_chr$Type = rep(NA, nrow(hg38_v_chm13_chr))
for(i in 1:nrow(hg38_v_chm13_chr)){
if(hg38_v_chm13_chr[i,"HG38_chr"] == hg38_v_chm13_chr[i,"CHM13_chr"]){
hg38_v_chm13_chr[i,"Type"] = "Same"
} else if(hg38_v_chm13_chr[i,"HG38_chr"] != hg38_v_chm13_chr[i,"CHM13_chr"] & length(unlist(strsplit(hg38_v_chm13_chr[i,"CHM13_chr"], ","))) == 1){
hg38_v_chm13_chr[i,"Type"] = "NonSyntenicSingleCopy"
} else if(length(unique(unlist(strsplit(hg38_v_chm13_chr[i,"CHM13_chr"], ",")))) == 1){
if(hg38_v_chm13_chr[i,"HG38_chr"] == unique(unlist(strsplit(hg38_v_chm13_chr[i,"CHM13_chr"], ",")))){
hg38_v_chm13_chr[i,"Type"] = "SyntenicDuplications"
} else{
hg38_v_chm13_chr[i,"Type"] = "NonSyntenicMultipleCopies"
}
} else if(length(unlist(strsplit(hg38_v_chm13_chr[i,"CHM13_chr"], ","))) > 1){
chrlist=unlist(strsplit(hg38_v_chm13_chr[i,"CHM13_chr"], ","))
if(hg38_v_chm13_chr[i,"HG38_chr"] %in% chrlist){
hg38_v_chm13_chr[i,"Type"] = "SyntenicAndNonSyntenicDuplications"
} else{
hg38_v_chm13_chr[i,"Type"] = "NonSyntenicMultipleCopies"
}
} else {
hg38_v_chm13_chr[i,"Type"] = "NA"
}
}
#hg38_v_chm13_chr$ChrChange = ifelse( hg38_v_chm13_chr$HG38_chr == hg38_v_chm13_chr$CHM13_chr, "Same", ifelse(hg38_v_chm13_chr$HG38_chr != hg38_v_chm13_chr$CHM13_chr & !grepl(",", hg38_v_chm13_chr$CHM13_chr), "DiffChr", "MultipleCopies"))
#hg38_v_chm13_chr$ChrMultiCopyChange = sapply(1:nrow(hg38_v_chm13_chr), function(i) {if(hg38_v_chm13_chr[i, "ChrChange"] != "MultipleCopies"){return("noCopies")}else{if(hg38_v_chm13_chr[i, "HG38_chr"] == unique(unlist(strsplit(hg38_v_chm13_chr[i, "CHM13_chr"], ",")))){return("SameCopy")}else{if(!hg38_v_chm13_chr[i, "HG38_chr"] %in% unique(unlist(strsplit(hg38_v_chm13_chr[i, "CHM13_chr"], ",")))){"JumpingCopy"}else{"SameAndDiff"}}}})
#table(hg38_v_chm13_chr$ChrChange)
#table(hg38_v_chm13_chr$ChrMultiCopyChange)
table(hg38_v_chm13_chr$Type)
circosCoord = NULL
for(ensg in hg38_v_chm13_chr[which(hg38_v_chm13_chr$HG38_chr != hg38_v_chm13_chr$CHM13_chr),"ensembl"]){
chm13Target=which(chm13_genes$ensembl == ensg)
for(i in chm13Target){
if(hg38_genes[ensg,"chrAdded"] != chm13_genes[i,"chr"]){
row=NULL
row$source_chr=hg38_genes[ensg,"chrAdded"]
row$source_start=hg38_genes[ensg,"start"]
row$source_end=hg38_genes[ensg,"end"]
row$target_chr=chm13_genes[i,"chr"]
row$target_start=chm13_genes[i,"start"]
row$target_end=chm13_genes[i,"end"]
circosCoord = rbind(circosCoord, row)
}
}
}
write.table(circosCoord, file="HG38_V_CHM13_jumpingGenes.ChordCircos.txt", quote = F, row.names = F, sep="\t")
circosCoord = as.data.frame(circosCoord)
hg38.v.chm13.jumpingGenes = data.frame("Species_1"=unname(unlist(circosCoord$source_chr)), "Start_1"=unname(unlist(circosCoord$source_start)), "End_1"=unname(unlist(circosCoord$source_end)), "Species_2"=unname(unlist(circosCoord$target_chr)), "Start_2"=unname(unlist(circosCoord$target_start)), "End_2"=unname(unlist(circosCoord$target_end)), "fill" = rep("cccccc", nrow(circosCoord)))
hg38.v.chm13.jumpingGenes$Species_1 = sapply(1:nrow(hg38.v.chm13.jumpingGenes), function(i) which(hg38RefSize$V1 == as.character(hg38.v.chm13.jumpingGenes[i,"Species_1"])))
hg38.v.chm13.jumpingGenes$Species_2 = unlist(sapply(1:nrow(hg38.v.chm13.jumpingGenes), function(i) which(chm13RefSize$V1 == as.character(hg38.v.chm13.jumpingGenes[i,"Species_2"]))))
ideogram(karyotype = hg38.chm13.ref, synteny = hg38.v.chm13.jumpingGenes, output = "HG38.v.CHM13.SyntenyPlot.svg")
convertSVG("HG38.v.CHM13.SyntenyPlot.svg", device = "png", file = "HG38.v.CHM13.SyntenyPlot.png")
hg38_chm13_SingleCopyDiffCHR = NULL
for(ensg in hg38_v_chm13_chr[which(hg38_v_chm13_chr$Type == "NonSyntenicSingleCopy"), "ensembl"]) {
hg38_chm13_SingleCopyDiffCHR = rbind(hg38_chm13_SingleCopyDiffCHR, c(hg38_genes[ensg, "chrAdded"], hg38_genes[ensg, "start"], hg38_genes[ensg, "end"], chm13_genes[which(chm13_genes$ensembl == ensg),"chr"], chm13_genes[which(chm13_genes$ensembl == ensg),"start"], chm13_genes[which(chm13_genes$ensembl == ensg),"end"], "cccccc"))
}
hg38_chm13_SingleCopyDiffCHR = data.frame(hg38_chm13_SingleCopyDiffCHR, stringsAsFactors = F)
colnames(hg38_chm13_SingleCopyDiffCHR) = c("Species_1", "Start_1", "End_1", "Species_2", "Start_2", "End_2", "fill")
hg38_chm13_SingleCopyDiffCHR$Start_1 = as.numeric(hg38_chm13_SingleCopyDiffCHR$Start_1)
hg38_chm13_SingleCopyDiffCHR$End_1= as.numeric(hg38_chm13_SingleCopyDiffCHR$End_1)
hg38_chm13_SingleCopyDiffCHR$Start_2 = as.numeric(hg38_chm13_SingleCopyDiffCHR$Start_2)
hg38_chm13_SingleCopyDiffCHR$End_2 = as.numeric(hg38_chm13_SingleCopyDiffCHR$End_2)
hg38_chm13_SingleCopyDiffCHR$Species_1 = sapply(1:nrow(hg38_chm13_SingleCopyDiffCHR), function(i) which(hg38RefSize$V1 == as.character(hg38_chm13_SingleCopyDiffCHR[i,"Species_1"])))
hg38_chm13_SingleCopyDiffCHR$Species_2 = unlist(sapply(1:nrow(hg38_chm13_SingleCopyDiffCHR), function(i) which(chm13RefSize$V1 == as.character(hg38_chm13_SingleCopyDiffCHR[i,"Species_2"]))))
ideogram(karyotype = hg38.chm13.ref, synteny = hg38_chm13_SingleCopyDiffCHR, output = "HG38.v.CHM13.JumpingGene.SyntenyPlot.svg")
convertSVG("HG38.v.CHM13.JumpingGene.SyntenyPlot.svg", device = "png", file = "HG38.v.CHM13.JumpingGene.SyntenyPlot.png")
hg38_chm13_CopyDiffCHR = NULL
for(ensg in hg38_v_chm13_chr[which(hg38_v_chm13_chr$Type == "NonSyntenicMultipleCopies"), "ensembl"]) {
chm13Rows = which(chm13_genes$ensembl == ensg)
for(i in chm13Rows){
hg38_chm13_CopyDiffCHR = rbind(hg38_chm13_CopyDiffCHR, c(hg38_genes[ensg, "chrAdded"], hg38_genes[ensg, "start"], hg38_genes[ensg, "end"], chm13_genes[i,"chr"], chm13_genes[i,"start"], chm13_genes[i,"end"], "cccccc"))
}
}
hg38_chm13_CopyDiffCHR = data.frame(hg38_chm13_CopyDiffCHR, stringsAsFactors = F)
colnames(hg38_chm13_CopyDiffCHR) = c("Species_1", "Start_1", "End_1", "Species_2", "Start_2", "End_2", "fill")
hg38_chm13_CopyDiffCHR$Start_1 = as.numeric(hg38_chm13_CopyDiffCHR$Start_1)
hg38_chm13_CopyDiffCHR$End_1= as.numeric(hg38_chm13_CopyDiffCHR$End_1)
hg38_chm13_CopyDiffCHR$Start_2 = as.numeric(hg38_chm13_CopyDiffCHR$Start_2)
hg38_chm13_CopyDiffCHR$End_2 = as.numeric(hg38_chm13_CopyDiffCHR$End_2)
hg38_chm13_CopyDiffCHR$Species_1 = sapply(1:nrow(hg38_chm13_CopyDiffCHR), function(i) which(hg38RefSize$V1 == as.character(hg38_chm13_CopyDiffCHR[i,"Species_1"])))
hg38_chm13_CopyDiffCHR$Species_2 = unlist(sapply(1:nrow(hg38_chm13_CopyDiffCHR), function(i) which(chm13RefSize$V1 == as.character(hg38_chm13_CopyDiffCHR[i,"Species_2"]))))
ideogram(karyotype = hg38.chm13.ref, synteny = hg38_chm13_CopyDiffCHR, output = "HG38.v.CHM13.MultipleCopies.SyntenyPlot.svg")
convertSVG("HG38.v.CHM13.MultipleCopies.SyntenyPlot.svg", device = "png", file = "HG38.v.CHM13.MultipleCopies.SyntenyPlot.png")
hg38_chm13_CopysameAndDiffCHR = NULL
for(ensg in hg38_v_chm13_chr[which(hg38_v_chm13_chr$Type == "SyntenicAndNonSyntenicDuplications"), "ensembl"]) {
chm13Rows = which(chm13_genes$ensembl == ensg)
for(i in chm13Rows){
hg38_chm13_CopysameAndDiffCHR = rbind(hg38_chm13_CopysameAndDiffCHR, c(hg38_genes[ensg, "chrAdded"], hg38_genes[ensg, "start"], hg38_genes[ensg, "end"], chm13_genes[i,"chr"], chm13_genes[i,"start"], chm13_genes[i,"end"], "cccccc"))
}
}
hg38_chm13_CopysameAndDiffCHR = data.frame(hg38_chm13_CopysameAndDiffCHR, stringsAsFactors = F)
colnames(hg38_chm13_CopysameAndDiffCHR) = c("Species_1", "Start_1", "End_1", "Species_2", "Start_2", "End_2", "fill")
hg38_chm13_CopysameAndDiffCHR$Start_1 = as.numeric(hg38_chm13_CopysameAndDiffCHR$Start_1)
hg38_chm13_CopysameAndDiffCHR$End_1= as.numeric(hg38_chm13_CopysameAndDiffCHR$End_1)
hg38_chm13_CopysameAndDiffCHR$Start_2 = as.numeric(hg38_chm13_CopysameAndDiffCHR$Start_2)
hg38_chm13_CopysameAndDiffCHR$End_2 = as.numeric(hg38_chm13_CopysameAndDiffCHR$End_2)
hg38_chm13_CopysameAndDiffCHR$Species_1 = sapply(1:nrow(hg38_chm13_CopysameAndDiffCHR), function(i) which(hg38RefSize$V1 == as.character(hg38_chm13_CopysameAndDiffCHR[i,"Species_1"])))
hg38_chm13_CopysameAndDiffCHR$Species_2 = unlist(sapply(1:nrow(hg38_chm13_CopysameAndDiffCHR), function(i) which(chm13RefSize$V1 == as.character(hg38_chm13_CopysameAndDiffCHR[i,"Species_2"]))))
ideogram(karyotype = hg38.chm13.ref, synteny = hg38_chm13_CopysameAndDiffCHR, output = "HG38.v.CHM13.SameAndDiffCopies.SyntenyPlot.svg")
convertSVG("HG38.v.CHM13.SameAndDiffCopies.SyntenyPlot.svg", device = "png", file = "HG38.v.CHM13.SameAndDiffCopies.SyntenyPlot.png")
hg38_chm13_CopySameCHR = NULL
for(ensg in hg38_v_chm13_chr[which(hg38_v_chm13_chr$Type == "SyntenicDuplications"), "ensembl"]) {
chm13Rows = which(chm13_genes$ensembl == ensg)
for(i in chm13Rows){
hg38_chm13_CopySameCHR = rbind(hg38_chm13_CopySameCHR, c(hg38_genes[ensg, "chrAdded"], hg38_genes[ensg, "start"], hg38_genes[ensg, "end"], chm13_genes[i,"chr"], chm13_genes[i,"start"], chm13_genes[i,"end"], "cccccc"))
}
}
hg38_chm13_CopySameCHR = data.frame(hg38_chm13_CopySameCHR, stringsAsFactors = F)
colnames(hg38_chm13_CopySameCHR) = c("Species_1", "Start_1", "End_1", "Species_2", "Start_2", "End_2", "fill")
hg38_chm13_CopySameCHR$Start_1 = as.numeric(hg38_chm13_CopySameCHR$Start_1)
hg38_chm13_CopySameCHR$End_1= as.numeric(hg38_chm13_CopySameCHR$End_1)
hg38_chm13_CopySameCHR$Start_2 = as.numeric(hg38_chm13_CopySameCHR$Start_2)
hg38_chm13_CopySameCHR$End_2 = as.numeric(hg38_chm13_CopySameCHR$End_2)
hg38_chm13_CopySameCHR$Species_1 = sapply(1:nrow(hg38_chm13_CopySameCHR), function(i) which(hg38RefSize$V1 == as.character(hg38_chm13_CopySameCHR[i,"Species_1"])))
hg38_chm13_CopySameCHR$Species_2 = unlist(sapply(1:nrow(hg38_chm13_CopySameCHR), function(i) which(chm13RefSize$V1 == as.character(hg38_chm13_CopySameCHR[i,"Species_2"]))))
ideogram(karyotype = hg38.chm13.ref, synteny = hg38_chm13_CopySameCHR, output = "HG38.v.CHM13.SameChrCopies.SyntenyPlot.svg")
convertSVG("HG38.v.CHM13.SameChrCopies.SyntenyPlot.svg", device = "png", file = "HG38.v.CHM13.SameChrCopies.SyntenyPlot.png")
merged_hg38_chm13Diff=rbind(hg38_chm13_SingleCopyDiffCHR, hg38_chm13_CopyDiffCHR, hg38_chm13_CopysameAndDiffCHR, hg38_chm13_CopySameCHR)
merged_hg38_chm13Diff$Type = c(rep("JumpingGene", nrow(hg38_chm13_SingleCopyDiffCHR)), rep("JumpingCopy", nrow(hg38_chm13_CopyDiffCHR)), rep("SameAndDiffCopy", nrow(hg38_chm13_CopysameAndDiffCHR)), rep("SameCHRCopy", nrow(hg38_chm13_CopySameCHR)))
pheatmap(log10(table(merged_hg38_chm13Diff[,c(1,4)]) + 1), cluster_rows = F, cluster_cols = F, colorRampPalette(c("navy","white", "firebrick3"))(20), main="All Copies")
pheatmap(log10(table(merged_hg38_chm13Diff[which(merged_hg38_chm13Diff$Species_1 != merged_hg38_chm13Diff$Species_2),c(1,4)]) + 1), cluster_rows = F, cluster_cols = F, colorRampPalette(c("navy","white", "firebrick3"))(20), main="All Copies, No Same CHR", )
pheatmap(log10(table(merged_hg38_chm13Diff[which(merged_hg38_chm13Diff$Type != "SameCHRCopy"),c(1,4)]) + 1), cluster_rows = F, cluster_cols = F, colorRampPalette(c("navy","white", "firebrick3"))(20), main="No SameCHRCopy")
pheatmap(log10(table(merged_hg38_chm13Diff[which(merged_hg38_chm13Diff$Type == "JumpingGene"),c(1,4)]) + 1), cluster_rows = F, cluster_cols = F, colorRampPalette(c("navy","white", "firebrick3"))(20), main="JumpingGene")
pheatmap(log10(table(merged_hg38_chm13Diff[which(merged_hg38_chm13Diff$Type == "JumpingCopy"),c(1,4)]) + 1), cluster_rows = F, cluster_cols = F, colorRampPalette(c("navy","white", "firebrick3"))(20), main="JumpingCopy")
pheatmap(log10(table(merged_hg38_chm13Diff[which(merged_hg38_chm13Diff$Type == "SameAndDiffCopy"), c(1,4)]) + 1), cluster_rows = F, cluster_cols = F, colorRampPalette(c("navy","white", "firebrick3"))(20), main="SameAndDiffCopy With Same CHR")
pheatmap(log10(table(merged_hg38_chm13Diff[which(merged_hg38_chm13Diff$Type == "SameAndDiffCopy" & merged_hg38_chm13Diff$Species_1 != merged_hg38_chm13Diff$Species_2),c(1,4)]) + 1), cluster_rows = F, cluster_cols = F, colorRampPalette(c("navy","white", "firebrick3"))(20), main="SameAndDiffCopy With Only Diff CHR")
mergedTable = melt(table(merged_hg38_chm13Diff[which(merged_hg38_chm13Diff$Species_1 != merged_hg38_chm13Diff$Species_2),c(1,4)]))
mergedTable = mergedTable[which(mergedTable$value > 0),]
mergedTable = mergedTable[order(mergedTable$value),]
Eventcolors=gsub("#","",colorRampPalette(c("honeydew","red"))(max(mergedTable$value)))
hg38_chm13_jumpingGenes_copy = NULL
for(i in 1:nrow(mergedTable)){
hg38_chrom=mergedTable[i, "Species_1"]
chm13_chrom=mergedTable[i, "Species_2"]
hg38_half=as.integer(hg38RefSize[hg38_chrom,"V2"]/2)
chm13_half=as.integer(chm13RefSize[chm13_chrom,"V2"]/2)
Start_1=hg38_half
Start_2=chm13_half
End_1=Start_1+100000
End_2=Start_2+100000
hg38_chm13_jumpingGenes_copy = rbind(hg38_chm13_jumpingGenes_copy, c(hg38_chrom, Start_1, End_1, chm13_chrom, Start_2, End_2 , Eventcolors[mergedTable[i, "value"]]))
for(j in 2:mergedTable[i,"value"]*10){
Start_1=Start_1+500000
Start_2=Start_2+500000
End_1=End_1+500000
End_2=End_2+500000
hg38_chm13_jumpingGenes_copy = rbind(hg38_chm13_jumpingGenes_copy, c(hg38_chrom, Start_1, End_1, chm13_chrom, Start_2, End_2 , Eventcolors[mergedTable[i, "value"]]))
}
}
hg38_chm13_jumpingGenes_copy = as.data.frame(hg38_chm13_jumpingGenes_copy)
colnames(hg38_chm13_jumpingGenes_copy) = c("Species_1", "Start_1", "End_1", "Species_2", "Start_2", "End_2", "fill")
hg38_chm13_jumpingGenes_copy$Species_1 = as.numeric(hg38_chm13_jumpingGenes_copy$Species_1)
hg38_chm13_jumpingGenes_copy$Start_1 = as.numeric(hg38_chm13_jumpingGenes_copy$Start_1)
hg38_chm13_jumpingGenes_copy$End_1 = as.numeric(hg38_chm13_jumpingGenes_copy$End_1)
hg38_chm13_jumpingGenes_copy$Species_2 = as.numeric(hg38_chm13_jumpingGenes_copy$Species_2)
hg38_chm13_jumpingGenes_copy$Start_2 = as.numeric(hg38_chm13_jumpingGenes_copy$Start_2)
hg38_chm13_jumpingGenes_copy$End_2 = as.numeric(hg38_chm13_jumpingGenes_copy$End_2)
ideogram(karyotype = hg38.chm13.ref, synteny = hg38_chm13_jumpingGenes_copy, output = "HG38.v.CHM13.CountsOfCopies.SyntenyPlot.svg")
convertSVG("HG38.v.CHM13.CountsOfCopies.SyntenyPlot.svg", device = "png", file = "HG38.v.CHM13.CountsOfCopies.SyntenyPlot.png")
hg38_v_chm13_strand = data.frame(ensembl=intersect(unique(chm13_genes$ensembl), rownames(hg38_genes)), HG38_strand=rep(NA,length(intersect(unique(chm13_genes$ensembl), rownames(hg38_genes)))), CHM13_strand=rep(NA, length(intersect(unique(chm13_genes$ensembl), rownames(hg38_genes)))))
hg38_v_chm13_strand$HG38_strand=hg38_genes[hg38_v_chm13_strand$ensembl, "strand"]
hg38_v_chm13_strand$CHM13_strand=sapply(1:nrow(hg38_v_chm13_strand), function(i) paste(unique(chm13_genes[which(chm13_genes$ensembl == hg38_v_chm13_strand[i, "ensembl"]),"strand"]), collapse = ","))
hg38_v_chm13_strand$CHM13_NumCopies=sapply(1:nrow(hg38_v_chm13_strand), function(i) length(chm13_genes[which(chm13_genes$ensembl == hg38_v_chm13_strand[i, "ensembl"]),"strand"]))
table(hg38_v_chm13_strand[,2:3])
hg38_v_chm13_strand$Type = hg38_v_chm13_chr$Type
table(hg38_v_chm13_strand[,5])
table(hg38_v_chm13_strand[,c(2,3,5)])
write.table(hg38_v_chm13_strand, file="Hg38_vs_chm13_strandDiff.txt", quote=F, sep = "\t", row.names = F)
ggplot(hg38_v_chm13_strand, aes(x=CHM13_NumCopies, color=Type)) + geom_density()
hg38_v_chm13_strand$GeneName = as.character(sapply(1:nrow(hg38_v_chm13_strand), function(i) hg38_genes[which(hg38_genes$gene_id == hg38_v_chm13_strand[i,"ensembl"]),"gene_name"]))
hg38_v_chm13_strand$Biotype = as.character(apply(1:nrow(hg38_v_chm13_strand), function(i) hg38_genes[which(hg38_genes$gene_id == hg38_v_chm13_strand[i,"ensembl"]),"gene_biotype"]))
hg38_v_chm13_strand$Biotype = as.character(apply(1:nrow(hg38_v_chm13_strand), function(i) hg38_genes[which(hg38_genes$gene_id == hg38_v_chm13_strand[i,"ensembl"]),"gene_biotype"]))
head(hg38_genes)
head(hg38_v_chm13_strand)
hg38_v_chm13_strand[which(hg38_v_chm13_strand$CHM13_NumCopies>1),]
nrow(hg38_v_chm13_strand[which(hg38_v_chm13_strand$CHM13_NumCopies>1),])
# Biotype
## Illumina250RL
### CHM13
Illumina250.CHM13.darkMerged = read.table("data/Illumina250_CHM13/Updated_Output_01_18_2024/Illumina250.Illumina250.T2T_CHM13_v2.0.dark-merged.bed", sep="\t", stringsAsFactors = F, header=F)
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
?dccRadioItems
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
nucsAndRegions
NewLongRead_nucsAndRegions
df2Use = NewLongRead_nucsAndRegions[which(NewLongRead_nucsAndRegions$Platform == xaxis_column_name), c("Region_type", "Platform", "Reference", "Nucleotide_count")]
xaxis_column_name="ONT"
df2Use = NewLongRead_nucsAndRegions[which(NewLongRead_nucsAndRegions$Platform == xaxis_column_name), c("Region_type", "Platform", "Reference", "Nucleotide_count")]
df2Use$type = rep("PrimarySupp", nrow(df2Use))
df2Use = rbind(df2Use, cbind(nucsAndRegions[which(NewLongRead_nucsAndRegions$Platform == xaxis_column_name), c("Region_type", "Platform", "Reference", "Nucleotide_count")], ))
df2Use
df2Use = rbind(df2Use, cbind(NewLongRead_nucsAndRegions[which(NewLongRead_nucsAndRegions$Platform == xaxis_column_name), c("Region_type", "Platform", "Reference", "Nucleotide_count")], ))
df2Use = rbind(df2Use, cbind(nucsAndRegions[which(nucsAndRegions$Platform == xaxis_column_name), c("Region_type", "Platform", "Reference", "Nucleotide_count")], rep("PrimaryOnly", length(which(NewLongRead_nucsAndRegions$Platform == xaxis_column_name)))))
df2Use = rbind(df2Use, cbind(nucsAndRegions[which(nucsAndRegions$Platform == xaxis_column_name), c("Region_type", "Platform", "Reference", "Nucleotide_count")], rep("PrimaryOnly", length(which(nucsAndRegions$Platform == xaxis_column_name)))))
df2Use
temp=nucsAndRegions[which(nucsAndRegions$Platform == xaxis_column_name), c("Region_type", "Platform", "Reference", "Nucleotide_count")]
temp$type = rep("PrimaryOnly", nrow(temp))
df2Use = rbind(df2Use, temp)
temp=NULL
df2Use
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R")
source("~/Documents/EbbertLab/CHM13PaperFigures/DRF_PaperApp_V2/DarkRegionApp.R", echo=TRUE)
